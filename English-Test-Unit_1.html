<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù…Ù„Ø®Øµ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ â€” Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (Ù†Ù‡Ø§Ø¦ÙŠ)</title>
<style>
:root{
  --bg1:#0b0a08;
  --bg2:#2f2419;
  --card: rgba(255,255,255,0.03);
  --gold:#b8873e;
  --gold-2:#e0b86a;
  --muted:#bdb7ad;
  --text:#f7f3ee;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family: "Segoe UI","Noto Kufi Arabic", Tahoma, system-ui, -apple-system; background:linear-gradient(160deg,var(--bg1),var(--bg2));color:var(--text);-webkit-font-smoothing:antialiased}
.app{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}

/* SPLASH */
.splash{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(6,4,2,0.92), rgba(20,14,8,0.95));z-index:999;flex-direction:column;padding:24px}
.splashCard{width:100%;max-width:820px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.006));border-radius:16px;padding:30px;text-align:center;box-shadow:0 24px 70px rgba(0,0,0,0.7);border:1px solid rgba(255,255,255,0.02)}
.splashLine{font-weight:900;font-size:20px;color:var(--gold);margin:6px 0}
.splashSubtitle{font-size:14px;color:var(--muted);margin-top:8px}
.startBtn{margin-top:18px;padding:14px 32px;border-radius:999px;border:none;background:linear-gradient(90deg,var(--gold),var(--gold-2));color:#0c0b08;font-weight:800;cursor:pointer;font-size:18px;box-shadow:0 16px 44px rgba(184,135,62,0.14);animation:pulse 2000ms infinite}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.03)}100%{transform:scale(1)}}

/* Layout */
.container{width:100%;max-width:980px;margin:0 auto}
header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:16px}
.titleBlock{text-align:right}
h1{margin:0;font-size:20px;font-weight:900;color:var(--gold-2)}
.dev{font-size:13px;color:var(--muted);margin-top:6px}

.card{background:linear-gradient(180deg, rgba(255,255,255,0.008), rgba(255,255,255,0.004));padding:18px;border-radius:14px;box-shadow:0 16px 40px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.02)}

.controlsRow{display:flex;gap:10px;align-items:center}
.btn{padding:12px 16px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--gold),var(--gold-2));color:#0c0b08;font-weight:800;cursor:pointer;box-shadow:0 10px 30px rgba(10,10,10,0.35);transition:transform .12s ease;font-size:15px}
.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
.btn:active{transform:translateY(2px)}

.question{margin:14px 0;padding:16px;border-radius:12px;background:linear-gradient(90deg, rgba(255,255,255,0.006), rgba(255,255,255,0.004));transition:transform .26s}
.qtext{font-weight:800;margin-bottom:12px;font-size:16px;color:var(--text)}
.choices{display:flex;flex-direction:column;gap:12px}
label.choice{display:flex;align-items:center;gap:14px;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);cursor:pointer;transition:background .14s ease,transform .12s}
label.choice:hover{transform:translateX(-6px);background:rgba(255,255,255,0.01)}
label.choice input{width:20px;height:20px}

/* progress */
.progress{height:12px;background:rgba(255,255,255,0.03);border-radius:999px;overflow:hidden;margin-bottom:12px}
.progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--gold),var(--gold-2));width:0%;transition:width .6s ease}

/* result */
.resultBox{margin-top:18px;padding:16px;border-radius:14px;text-align:center;font-size:18px;font-weight:900;display:none}
.resultBox.success{color:var(--gold);box-shadow:0 0 34px rgba(224,184,106,0.16);animation:popIn .56s ease}
.resultBox.fail{color:#ff9aa2;box-shadow:0 0 30px rgba(244,63,94,0.12);animation:shake .6s ease}
@keyframes popIn{0%{transform:scale(.86);opacity:0}100%{transform:scale(1);opacity:1}}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}

.small{font-size:13px;color:var(--muted)}
footer{margin-top:14px;text-align:center;color:var(--muted);font-size:12px}

@media (max-width:540px){
  .startBtn{font-size:16px;padding:12px 22px}
  .qtext{font-size:15px}
  .btn{font-size:15px;padding:12px}
  .splashLine{font-size:18px}
}
</style>
</head>
<body>

<!-- SPLASH -->
<div class="splash" id="splash" role="dialog" aria-labelledby="splashTitle">
  <div class="splashCard">
    <div class="splashLine">Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ø£Ø³ØªØ§Ø°: Ø¨Ø§Ø³Ù…</div>
    <div class="splashLine">Ø§Ù„Ù…ØµÙ…Ù…: Ù…Ø§Ù„Ùƒ</div>
    <div class="splashSubtitle">Ù…Ù„Ø®Øµ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ â€” Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</div>
    <button id="startBtn" class="startBtn" aria-label="Ø§Ø¨Ø¯Ø£">Ø§Ø¨Ø¯Ø£</button>
  </div>
</div>

<!-- APP -->
<div class="app" id="appRoot" aria-hidden="true">
  <div class="container">
    <header>
      <div class="titleBlock">
        <h1>Ù…Ù„Ø®Øµ Ù…Ø±Ø§Ø¬Ø¹Ø© â€” Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰</h1>
        <div class="dev">Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© â€” Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</div>
      </div>
      <div class="controlsRow">
        <button id="restartBtn" class="btn ghost">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</button>
      </div>
    </header>

    <main class="card" id="quizCard" role="application">
      <div class="progress" aria-hidden="true"><i id="progBar"></i></div>
      <div id="qList" aria-live="polite"></div>

      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:14px">
        <div>
          <button class="btn" id="prevBtn">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
          <button class="btn" id="nextBtn">Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </div>
        <div class="small">Ø³Ø¤Ø§Ù„ <span id="currentNum">0</span> / <span id="totalNum">0</span></div>
      </div>

      <div id="endControls" style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end;align-items:center">
        <button class="btn" id="submitBtn" style="display:none">Ø¥Ø±Ø³Ø§Ù„ ÙˆØªØµØ­ÙŠØ­</button>
      </div>

      <div id="resultArea" class="resultBox" role="status"></div>
    </main>

    <footer>Ø¨Ø§Ù„ØªÙˆÙÙŠÙ‚! âœ¨</footer>
  </div>
</div>

<script>
/* ====== Cleaned & reworded questions (Arabic exam-style) ======
   Removed ambiguous/robotic questions.
   Sections: Conversation -> Vocabulary/Antonyms -> Word formation -> Grammar
*/
const questions = [
  /* Conversation */
  { q: 'Ø§Ø®ØªØ± Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ù…Ù‚Ø§Ø³ (Ø§Ù„Ø­Ø¬Ù…):', choices:['What color?','What size?','What price?','How many?'], answer:1 },
  { q: 'Ø§Ø®ØªØ± Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ù„ÙˆÙ†:', choices:['What size?','What color?','How long?','Who?'], answer:1 },
  { q: 'Ø§Ø®ØªØ± Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø³Ø¹Ø±:', choices:['What size?','What color?','What price?','When?'], answer:2 },
  { q: 'Ù„Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© (ÙƒÙ… Ø§Ù„Ù…Ø¯Ø©) Ù†Ø³ØªØ®Ø¯Ù…:', choices:['What color?','How long?','How many?','Which?'], answer:1 },
  { q: 'ÙƒÙŠÙ Ù†Ø­ÙˆÙ„ Ø§Ù„Ø¬Ù…Ù„Ø© "Yes, she has." Ø¥Ù„Ù‰ Ø³Ø¤Ø§Ù„ØŸ', choices:['Has she?','Does she?','Is she?','She has?'], answer:0 },
  { q: 'Ø¥Ø°Ø§ Ø£Ø±Ø¯Ù†Ø§ Ø£Ù† Ù†Ø¹Ø±Ù Ù…Ù† Ù…Ø¹ Ø§Ù„Ø´Ø®Øµ (Ù…Ø¹ Ù…Ù†)ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ø³Ø¤Ø§Ù„:', choices:['What?','Who?','When?','How?'], answer:1 },
  { q: 'Ù…Ø§ Ø§Ù„Ø²Ù…Ù† Ø§Ù„Ø°ÙŠ Ù†Ø³ØªØ®Ø¯Ù…Ù‡ Ù…Ø¹ did ÙÙŠ Ø§Ù„Ø³Ø¤Ø§Ù„ØŸ', choices:['Present simple','Past simple','Present perfect','Future'], answer:1 },
  { q: 'Ø§ÙƒÙ…Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„: Where ____? (Ù„Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù† Ù…ÙƒØ§Ù† Ø§Ù„Ø³ÙƒÙ†)', choices:['does he live','he lives','do he live','lives he'], answer:0 },

  /* Vocabulary & antonyms */
  { q: 'Ù…Ø§ Ø¹ÙƒØ³ "inside"ØŸ', choices:['outside','near','between','over'], answer:0 },
  { q: 'Ù…Ø§ Ù…Ø±Ø§Ø¯Ù "simple"ØŸ', choices:['hard','easy','strange','strong'], answer:1 },
  { q: 'Ù…Ø§ Ø§Ù„Ø¹ÙƒØ³ Ø§Ù„ØµØ­ÙŠØ­ Ù„ÙƒÙ„Ù…Ø© "strong"ØŸ', choices:['weak','hard','soft','cold'], answer:0 },
  { q: 'Ù…Ø§ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…Ù† "kind" Ù„ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ Ø§Ø³Ù…ØŸ', choices:['kindly','kindness','kindful','unkind'], answer:1 },
  { q: 'Ù…Ø§ Ù…Ø±Ø§Ø¯Ù "popular"ØŸ', choices:['famous','unique','rare','quiet'], answer:0 },
  { q: 'Ù…Ø§ Ø¹ÙƒØ³ "strange"ØŸ', choices:['familiar','unique','famous','weak'], answer:0 },
  { q: 'Ù…Ø§ Ù…Ø±Ø§Ø¯Ù "stressed"ØŸ', choices:['worried','relaxed','happy','calm'], answer:0 },

  /* Word formation */
  { q: 'Ø§Ø¶Ù Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©: person â†’ ... (Ù„ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ ØµÙØ©)', choices:['personly','personal','personate','personful'], answer:1 },
  { q: 'Ø§Ø¶Ù Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©: comfort â†’ ...', choices:['comfortful','comfortable','comfortive','comfortless'], answer:1 },
  { q: 'Ø§Ø¶Ù Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©: care â†’ ... (ØµÙŠØºØ© ØµÙØ©)', choices:['careful','carful','careless','caring'], answer:0 },
  { q: 'ØªØ­ÙˆÙŠÙ„ "strong" Ø¥Ù„Ù‰ Ø§Ø³Ù… Ù…Ù†Ø§Ø³Ø¨ Ù‡Ùˆ:', choices:['strongness','strength','strongful','stronge'], answer:1 },
  { q: 'ØªØ­ÙˆÙŠÙ„ "grow" Ø¥Ù„Ù‰ Ø§Ø³Ù… ÙŠØ­Ø¯Ø« Ø¨Ù‡:', choices:['growing','growth','growth','grew'], answer:2 },
  { q: 'ØªØ­ÙˆÙŠÙ„ "color" Ø¥Ù„Ù‰ ØµÙØ©: ...', choices:['colorful','colorless','colorive','colorly'], answer:0 },
  { q: 'ØªØ­ÙˆÙŠÙ„ "honest" Ø¥Ù„Ù‰ ØµÙŠØºØ© Ø§Ø³Ù…/n: ...', choices:['honesty','honestness','honestful','honestify'], answer:0 },

  /* Vocabulary meanings (short) */
  { q: 'Ù…Ø¹Ù†Ù‰ "identity" Ù‡Ùˆ:', choices:['Ø®Ù„ÙÙŠØ©','Ù‡ÙˆÙŠØ©','Ù‚ÙŠÙ…Ø©','Ø´ÙƒÙ„'], answer:1 },
  { q: 'Ù…Ø¹Ù†Ù‰ "background" Ù‡Ùˆ:', choices:['Ø®Ù„ÙÙŠØ©','ÙØ±Ø­','ØµØºÙŠØ±','Ù‚Ø¯ÙŠÙ…'], answer:0 },
  { q: 'Ù…Ø¹Ù†Ù‰ "unique" Ù‡Ùˆ:', choices:['Ù…Ø´Ø§Ø¹','Ù…Ø¹Ù„ÙˆÙ…','ÙØ±ÙŠØ¯','Ø¹Ø§Ø¯ÙŠ'], answer:2 },
  { q: 'Ù…Ø¹Ù†Ù‰ "value" Ù‡Ùˆ:', choices:['Ù‚ÙŠÙ…Ø©','Ø­Ø¬Ù…','Ù„ÙˆÙ†','Ø´ÙƒÙ„'], answer:0 },
  { q: 'Ù…Ø¹Ù†Ù‰ "belief" Ù‡Ùˆ:', choices:['Ø§Ø¹ØªÙ‚Ø§Ø¯','ØªØ¬Ø±Ø¨Ø©','Ù…Ø¸Ù‡Ø±','Ù‡Ø¯ÙˆØ¡'], answer:0 },
  { q: 'Ù…Ø¹Ù†Ù‰ "self-discovery" Ù‡Ùˆ:', choices:['Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø°Ø§Øª','ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø®Ø¨Ø±Ø©','Ø®Ø¬Ù„','Ø±Ø§Ø­Ø©'], answer:0 },
  { q: 'Ù…Ø¹Ù†Ù‰ "self-respect" Ù‡Ùˆ:', choices:['Ø§Ø­ØªØ±Ø§Ù… Ø§Ù„Ø°Ø§Øª','Ø®Ø¬Ù„','Ø®Ø³Ø§Ø±Ø©','ÙØ®Ø±'], answer:0 },
  { q: 'ÙØ¹Ù„ "support" ÙŠØ¹Ù†ÙŠ:', choices:['ÙŠØ¯Ø¹Ù…','ÙŠÙ†ØªÙ‚Ø¯','ÙŠÙ„ØºÙŠ','ÙŠØ´Ø§Ù‡Ø¯'], answer:0 },
  { q: 'ØªØ±Ø¬Ù…Ø© "mirror" Ù‡ÙŠ:', choices:['Ù†Ø§ÙØ°Ø©','Ù…Ø±Ø¢Ø©','Ø¯ÙØªØ±','Ù‚Ù„Ù…'], answer:1 },
  { q: 'Ù…Ø¹Ù†Ù‰ "adjust" Ù‡Ùˆ:', choices:['ÙŠØ¶Ø¨Ø·','ÙŠØ¨ÙŠØ¹','ÙŠÙ†Ø³Ù‰','ÙŠØ£ÙƒÙ„'], answer:0 },
  { q: 'Ù…Ø¹Ù†Ù‰ "curious" Ù‡Ùˆ:', choices:['ÙØ¶ÙˆÙ„ÙŠ','Ø®Ø¬ÙˆÙ„','Ù‡Ø§Ø¯Ø¦','ÙƒØ³ÙˆÙ„'], answer:0 },
  { q: 'Ù…Ø¹Ù†Ù‰ "worth" Ù‡Ùˆ:', choices:['ÙŠØ³ØªØ­Ù‚','ÙŠØªÙƒÙ„Ù…','ÙŠØªØ­Ø±Ùƒ','ÙŠØªÙˆÙ‚Ù'], answer:0 },
  { q: 'Ù…Ø¹Ù†Ù‰ "proud of" Ù‡Ùˆ:', choices:['Ø®Ø¬ÙˆÙ„ Ù…Ù†','ÙØ®ÙˆØ± Ø¨','Ø­Ø²ÙŠÙ† Ù„','ØºÙŠØ± Ù…Ù‡ØªÙ…'], answer:1 },
  { q: 'Ù…Ø¹Ù†Ù‰ "depressing" Ù‡Ùˆ:', choices:['Ù…ÙØ±Ø­','Ù…Ø­Ø¨Ø·','ØºÙŠØ± ÙˆØ§Ø¶Ø­','Ø³Ù‡Ù„'], answer:1 },
  { q: 'Ù…Ø¹Ù†Ù‰ "notice" Ù‡Ùˆ:', choices:['ÙŠÙ†Ø³Ù‰','ÙŠÙ„Ø­Ø¸','ÙŠØªÙˆÙ‚Ù','ÙŠØ¨Ø¯Ø£'], answer:1 },
  { q: 'Ù…Ø¹Ù†Ù‰ "responsibility" Ù‡Ùˆ:', choices:['Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©','Ø³Ø¤Ø§Ù„','Ù…Ø±Ø­','Ù‚ÙŠÙ…Ø©'], answer:0 },
  { q: 'Ù…Ø¹Ù†Ù‰ "shape" Ù‡Ùˆ:', choices:['Ø´ÙƒÙ„','Ù‚ÙŠÙ…Ø©','Ù…ÙƒØ§Ù†','Ø²Ù…Ø§Ù†'], answer:0 },
  { q: 'Ù…Ø¹Ù†Ù‰ "experience" Ù‡Ùˆ:', choices:['ØªØ¬Ø±Ø¨Ø©','Ù‡Ø¯ÙŠØ©','Ù…ÙƒØ§Ù†','Ù„ÙˆÙ†'], answer:0 },
  { q: 'Ù…Ø¹Ù†Ù‰ "outgoing" Ù‡Ùˆ:', choices:['Ù…Ù†ÙØªØ­','Ø®Ø¬ÙˆÙ„','Ù‚ÙˆÙŠ','Ù‡Ø§Ø¯Ø¦'], answer:0 },
  { q: 'Ù…Ø¹Ù†Ù‰ "sketch" Ù‡Ùˆ:', choices:['Ù„ÙˆØ­Ø©','Ø¯ÙØªØ± Ø±Ø³Ù…','Ù…Ù‚Ø¹Ø¯','Ø¨ÙŠØª'], answer:1 },
  { q: 'Ù…Ø¹Ù†Ù‰ "curls" ÙÙŠ Ø³ÙŠØ§Ù‚ Ø§Ù„Ø´Ø¹Ø± Ù‡Ùˆ:', choices:['ØªØ¬Ø§Ø¹ÙŠØ¯','ØªÙ…ÙˆØ¬Ø§Øª Ø´Ø¹Ø±','Ø®Ø·ÙˆØ·','Ø£Ø·ÙˆØ§Ù‚'], answer:1 },

  /* Grammar patterns */
  { q: 'ØµÙŠØºØ©: "have/has + past participle" Ù†Ø³ØªØ®Ø¯Ù…Ù‡Ø§ Ù„Ù„Ø¯Ù„Ø§Ù„Ø© Ø¹Ù„Ù‰ Ø£ÙŠ Ø²Ù…Ù†ØŸ', choices:['Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ø¨Ø³ÙŠØ·','Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„','Ø§Ù„Ù…Ø¶Ø§Ø±Ø¹ Ø§Ù„ØªØ§Ù… (present perfect)','Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø§Ù„Ù…Ø³ØªÙ…Ø±'], answer:2 },
  { q: 'Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ù…Ø¨Ù†ÙŠØ© Ù„Ù„Ù…Ø¬Ù‡ÙˆÙ„ Ø¹Ø§Ø¯Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ "by" Ù„ÙÙ€:', choices:['Ø§Ù„Ù…Ø¨Ù†Ù‰ Ø§Ù„ÙØ§Ø¹Ù„','Ø§Ù„Ø²Ù…Ù†','Ø§Ù„Ù…ÙƒØ§Ù†','Ø§Ù„Ø³Ø¨Ø¨'], answer:0 },
  { q: 'Ù†Ø³ØªØ®Ø¯Ù… "for" Ù…Ø¹:', choices:['Ù†Ù‚Ø·Ø© Ø²Ù…Ù†ÙŠØ© Ù…Ø­Ø¯Ø¯Ø©','ÙØªØ±Ø© Ø²Ù…Ù†ÙŠØ©','Ù…ÙƒØ§Ù†','Ø³Ø¨Ø¨'], answer:1 },
  { q: 'Ù†Ø³ØªØ®Ø¯Ù… "since" Ù…Ø¹:', choices:['Ù†Ù‚Ø·Ø© Ø²Ù…Ù†ÙŠØ© Ù…Ø­Ø¯Ø¯Ø©','Ø¹Ø¯Ø¯','Ù…ÙƒØ§Ù†','Ø·Ø±ÙŠÙ‚Ø©'], answer:0 },
  { q: 'Ø§ÙƒÙ…Ù„: "Have you ___ your homework yet?"', choices:['do','did','done','doing'], answer:2 },
  { q: '"ever" ØºØ§Ù„Ø¨Ù‹Ø§ ØªÙØ³ØªØ®Ø¯Ù… ÙÙŠ:', choices:['Ø§Ù„Ø¬Ù…Ù„ Ø§Ù„Ù†ÙÙŠ','Ø§Ù„Ø£Ø³Ø¦Ù„Ø©','Ø§Ù„Ø£ÙˆØ§Ù…Ø±','Ø§Ù„Ø´Ø±Ø­'], answer:1 },
  { q: 'ÙÙŠ Ø§Ù„Ù†ÙÙŠ Ù…Ø¹ present perfect: Haven\'t / hasn\'t ØºØ§Ù„Ø¨Ù‹Ø§ ØªØ£ØªÙŠ Ù…Ø¹ Ø£ÙŠ ÙƒÙ„Ù…Ø©ØŸ', choices:['yet','ever','since','for'], answer:0 }
];

/* ====== Audio (WebAudio) ====== */
let audioCtx = null;
function ensureAudio(){ if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }

function playClick(){
  try{
    if(!audioCtx) ensureAudio();
    const t = audioCtx.currentTime;
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.type = 'sine'; o.frequency.value = 900;
    g.gain.value = 0.001;
    o.connect(g); g.connect(audioCtx.destination);
    o.start(t); g.gain.exponentialRampToValueAtTime(0.0001, t + 0.06);
    setTimeout(()=>o.stop(),80);
  }catch(e){}
}

function playSuccess(){
  try{
    if(!audioCtx) ensureAudio();
    const now = audioCtx.currentTime;
    const g = audioCtx.createGain(); g.gain.value = 0.0013;
    const o1 = audioCtx.createOscillator(); o1.type='sine'; o1.frequency.value = 440;
    const o2 = audioCtx.createOscillator(); o2.type='sine'; o2.frequency.value = 660;
    o1.connect(g); o2.connect(g); g.connect(audioCtx.destination);
    o1.start(now); o2.start(now + 0.02);
    g.gain.exponentialRampToValueAtTime(0.0001, now + 0.9);
    setTimeout(()=>{ o1.stop(); o2.stop(); }, 1000);
  }catch(e){}
}

function playFail(){
  try{
    if(!audioCtx) ensureAudio();
    const now = audioCtx.currentTime;
    const g = audioCtx.createGain(); g.gain.value = 0.0012;
    const seq = [360, 300, 420];
    seq.forEach((f,i)=>{
      const o = audioCtx.createOscillator(); o.type='triangle'; o.frequency.value = f;
      o.connect(g); g.connect(audioCtx.destination);
      const s = now + i*0.12;
      o.start(s); o.stop(s + 0.09);
    });
    g.gain.exponentialRampToValueAtTime(0.0001, now + seq.length*0.12 + 0.12);
  }catch(e){}
}

/* ====== UI logic ====== */
let current = 0;
const total = questions.length;
const qList = document.getElementById('qList');
const currentNum = document.getElementById('currentNum');
const totalNum = document.getElementById('totalNum');
const progBar = document.getElementById('progBar');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const submitBtn = document.getElementById('submitBtn');
const resultArea = document.getElementById('resultArea');
const splash = document.getElementById('splash');
const startBtn = document.getElementById('startBtn');
const restartBtn = document.getElementById('restartBtn');

function renderQuestion(i){
  qList.innerHTML = '';
  const item = questions[i];
  const wrap = document.createElement('div'); wrap.className='question';
  const qtxt = document.createElement('div'); qtxt.className='qtext'; qtxt.textContent = (i+1)+'. '+item.q;
  wrap.appendChild(qtxt);
  const choices = document.createElement('div'); choices.className='choices';
  item.choices.forEach((c, idx)=>{
    const lab = document.createElement('label'); lab.className='choice';
    const inp = document.createElement('input'); inp.type = 'radio'; inp.name = 'q'+i; inp.value = idx;
    const saved = localStorage.getItem('quiz_ans_'+i);
    if(saved && Number(saved) === idx) inp.checked = true;
    inp.addEventListener('change', ()=>{ localStorage.setItem('quiz_ans_'+i, idx); playClick(); updateProgress(); checkShowSubmit(); });
    lab.appendChild(inp); lab.appendChild(document.createTextNode(c));
    choices.appendChild(lab);
  });
  wrap.appendChild(choices);
  qList.appendChild(wrap);
  currentNum.textContent = i+1; totalNum.textContent = total;
  progBar.style.width = Math.round((i/total)*100) + '%';
  wrap.style.opacity = '0'; wrap.style.transform = 'translateY(8px)';
  setTimeout(()=>{ wrap.style.transition = 'all .36s ease'; wrap.style.opacity='1'; wrap.style.transform='translateY(0)'; }, 40);
}

function saveAns(i){
  const r = document.querySelector('input[name="q'+i+'"]:checked');
  if(r) localStorage.setItem('quiz_ans_'+i, r.value);
}

prevBtn.addEventListener('click', ()=>{ saveAns(current); if(current>0){ current--; renderQuestion(current);} });
nextBtn.addEventListener('click', ()=>{ saveAns(current); if(current<total-1){ current++; renderQuestion(current);} });

function updateProgress(){
  const answered = questions.filter((_,i)=> localStorage.getItem('quiz_ans_'+i) !== null).length;
  progBar.style.width = Math.round((answered/total)*100) + '%';
  if(answered === total){
    submitBtn.style.display = 'inline-block';
  } else {
    submitBtn.style.display = 'none';
  }
}
function checkShowSubmit(){ updateProgress(); }

submitBtn.addEventListener('click', ()=>{
  saveAns(current);
  let score = 0, wrongCount = 0;
  let outHTML = '';
  for(let i=0;i<questions.length;i++){
    const ans = localStorage.getItem('quiz_ans_'+i);
    const ok = (ans!==null && Number(ans)===questions[i].answer);
    if(ok) score++; else wrongCount++;
    outHTML += `<div style="padding:10px;border-top:1px solid rgba(255,255,255,0.03);text-align:right;cursor:pointer" onclick="(function(){current=${i};renderQuestion(${i});window.scrollTo({top:0,behavior:'smooth'})})()">${ok? 'âœ…':'âŒ'} Ø³Ø¤Ø§Ù„ ${i+1}: ${questions[i].q} <div class='small'>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: ${questions[i].choices[questions[i].answer]}</div></div>`;
  }

  resultArea.style.display = 'block';
  resultArea.className = 'resultBox';
  resultArea.innerHTML = `<div style="font-weight:900;font-size:18px">Ø¯Ø±Ø¬ØªÙƒ: ${score}/${questions.length}</div><div class="small" style="margin-top:8px">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ø³Ø¤Ø§Ù„ Ù„Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„ÙŠÙ‡.</div><div style="margin-top:12px;text-align:right">${outHTML}</div>`;

  if(wrongCount === 0){
    resultArea.classList.add('success');
    try{ playSuccess(); }catch(e){}
  } else if(wrongCount >= 2){
    resultArea.classList.add('fail');
    try{ playFail(); }catch(e){}
  } else {
    resultArea.style.boxShadow = '0 10px 30px rgba(255,255,255,0.02)';
  }
  resultArea.scrollIntoView({behavior:'smooth', block:'center'});
});

/* start / restart */
startBtn.addEventListener('click', ()=>{
  ensureAudio();
  if(audioCtx && audioCtx.state === 'suspended'){
    audioCtx.resume().then(()=>console.log("ğŸ”Š audio resumed"));
  }
  try{ playClick(); }catch(e){}
  splash.style.display = 'none';
  document.getElementById('appRoot').setAttribute('aria-hidden','false');
  renderQuestion(current);
  updateProgress();
  window.scrollTo({top:0,behavior:'smooth'});
});

restartBtn.addEventListener('click', ()=>{
  if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª ÙˆØ§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯ØŸ')) return;
  for(let i=0;i<questions.length;i++) localStorage.removeItem('quiz_ans_'+i);
  current = 0;
  resultArea.style.display = 'none';
  renderQuestion(current);
  updateProgress();
  splash.style.display = 'flex';
});

/* init */
(function(){ totalNum.textContent = total; renderQuestion(current); updateProgress(); })();
</script>
</body>
</html>
